<div class="calendar-container">
  <div class="top-controls">
    <div class="control-group">
      <app-view-mode-selector 
        [viewMode]="viewMode()" 
        (viewModeChange)="setViewMode($event)">
      </app-view-mode-selector>

      <app-category-selector 
        [selectedCategory]="selectedCategory()" 
        [categories]="categories"
        (categoryChange)="selectCategory($event)">
      </app-category-selector>

      <app-add-task-button 
        (addTaskClick)="onAddTaskClick()">
      </app-add-task-button>
    </div>
  </div>

  <div class="main-content">
    <!-- LEFT SIDE: NOTES -->
      <!-- This section can contain daily view notes if needed -->
    <!-- <div class="notes-sidebar">
     
    </div> -->

    <!-- SPIRAL DIVIDER -->
    <!-- <div class="spiral-divider"></div> -->

    <!-- CENTER: CALENDAR -->
    <div class="calendar-column">
      <!-- EVENT DETAIL -->
      <app-event-detail
        *ngIf="selectedEvent()"
        [event]="selectedEvent()!"
        [categories]="categories"
        (eventUpdate)="onEventUpdate($event)"
        (eventDelete)="onEventDelete()"
        (eventClose)="onEventDetailClose()">
      </app-event-detail>

      <!-- CALENDAR VIEWS -->
      <app-calendar-daily *ngIf="viewMode() === 'daily'"
        [selectedDate]="selectedDate()"
        [events]="dailyEvents(selectedDate())"
        [categories]="categories"
        [startHour]="startHour"
        [endHour]="endHour"
        (eventClick)="onEventClick($event)">
      </app-calendar-daily>

      <app-calendar-weekly *ngIf="viewMode() === 'weekly'"
        [weekDays]="weekDays()"
        [categories]="categories"
        (eventClick)="onEventClick($event)">
      </app-calendar-weekly>

      <app-calendar-monthly *ngIf="viewMode() === 'monthly'"
        [calendarDays]="calendarDays()"
        [categories]="categories"
        (eventClick)="onEventClick($event)">
      </app-calendar-monthly>
    </div>

    <!-- SPIRAL DIVIDER -->
    <div class="spiral-divider"></div>

    <!-- RIGHT SIDE: TOP PRIORITIES + TODAY'S EVENTS -->
    <div class="events-sidebar">
      <!-- TOP PRIORITIES BOX (Daily view only) -->
      <mat-card class="priorities-box" *ngIf="viewMode() === 'daily'">
        <mat-card-header class="priorities-header">
          <h3>Top Priorities</h3>
        </mat-card-header>
        <mat-card-content class="priorities-content">
          <div *ngIf="topPriorities().length > 0; else noPriorities" class="priorities-list">
            <div *ngFor="let task of topPriorities()" class="priority-item">
              <div class="priority-indicator" [style.background-color]="getCategoryColor(task.category)"></div>
              <div class="priority-task-info">
                <div class="priority-title">{{ task.title }}</div>
                <div class="priority-time">{{ task.time }}</div>
              </div>
            </div>
          </div>
          <ng-template #noPriorities>
            <p class="no-priorities">No priority tasks for today</p>
          </ng-template>
        </mat-card-content>
      </mat-card>

      <!-- TODAY'S EVENTS LIST -->
      <app-events-list
        [events]="todaysEvents()"
        [viewMode]="viewMode()"
        [categories]="categories"
        (eventClick)="onEventClick($event)">
      </app-events-list>
    </div>
  </div>
</div>
